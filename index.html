<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2025 Archive - Minimal Style</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
      body {
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f0f0f0;
        display: flex;
        flex-direction: column;
        align-items: center;
        -webkit-font-smoothing: antialiased;
      }

      #poster-area {
        width: 380px;
        background-color: #ffffff;
        padding: 60px 15px;
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        align-items: center;
        overflow: hidden;
      }

      .header-box {
        background-color: #000;
        width: 280px;
        height: 140px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 60px;
      }
      .white-oval {
        background-color: #fff;
        width: 92%;
        height: 85%;
        border-radius: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .white-oval span {
        color: #000;
        font-size: 85px;
        font-weight: 900;
        letter-spacing: -4px;
        line-height: 1;
      }

      #gallery {
        display: grid;
        grid-template-columns: 1fr 1fr;
        column-gap: 5px;
        row-gap: 40px;
        width: 100%;
      }

      .item {
        display: flex;
        align-items: center;
        justify-content: center;
        min-width: 0;
      }

      .num {
        width: 30px;
        font-size: 24px;
        font-weight: 800;
        letter-spacing: -1px;
        text-align: right;
        margin-right: 4px;
        flex-shrink: 0;
      }

      .bracket {
        font-size: 50px;
        font-weight: 800;
        line-height: 1;
        flex-shrink: 0;
        color: #000;
      }

      .img-placeholder {
        width: 90px;
        height: 65px;
        margin: 0 2px;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        flex-shrink: 0;
      }

      .img-placeholder img {
        max-width: 100%;
        max-height: 100%;
        width: auto;
        height: auto;
        object-fit: contain;
        display: block;
      }

      .footer {
        width: 100%;
        margin-top: 70px;
        border-top: 3.5px solid #000;
        padding-top: 30px;
      }

      .barcode-container {
        width: 100%;
        height: 60px;
        display: flex;
        justify-content: space-between;
        align-items: stretch;
        margin-bottom: 30px; /* 숫자 없어진 만큼 여백 조정 */
      }
      .b-line {
        background-color: #000;
        flex-shrink: 0;
      }

      .footer-text-display {
        width: 100%;
        font-size: 15px;
        font-weight: 800;
        letter-spacing: 1px;
        color: #000;
        text-transform: uppercase;
        text-align: center;
        outline: none;
        border: none;
        background: transparent;
      }

      /* 컨트롤 버튼 1열 배치 수정 */
      .controls {
        margin: 40px 0;
        display: flex;
        flex-direction: row; /* 가로 배치 */
        gap: 10px;
        width: 380px;
        justify-content: center;
      }
      .btn {
        flex: 1; /* 버튼 너비를 동일하게 배분 */
        background: #000;
        color: #fff;
        border: none;
        padding: 14px 0;
        border-radius: 50px;
        font-weight: bold;
        cursor: pointer;
        font-size: 13px;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div id="poster-area">
      <div class="header-box">
        <div class="white-oval"><span>2025</span></div>
      </div>
      <div id="gallery"></div>
      <div class="footer">
        <div class="barcode-container" id="barcode-area"></div>
        <div class="footer-text-display" id="remarks" contenteditable="true">
          ENTER YOUR 2025 CLOSING REMARKS
        </div>
      </div>
    </div>

    <div class="controls">
      <input type="file" id="file-input" multiple hidden />
      <button
        class="btn"
        onclick="document.getElementById('file-input').click()"
      >
        SELECT PHOTOS
      </button>
      <button class="btn" id="save-btn">SAVE IMAGE</button>
    </div>

    <script>
      const gallery = document.getElementById('gallery');
      const barcodeArea = document.getElementById('barcode-area');
      const fileInput = document.getElementById('file-input');
      const saveBtn = document.getElementById('save-btn');
      let count = 0;

      // 바코드 생성
      const pattern = [
        2, 1, 4, 1, 2, 3, 2, 5, 1, 2, 4, 1, 3, 2, 1, 2, 4, 1, 3, 1, 2, 5, 1, 2,
        4, 1, 3, 2, 1, 2, 4, 1, 3, 2, 1, 2, 4, 1, 3, 2, 1, 2, 4, 1, 3, 2,
      ];
      pattern.forEach((w) => {
        const line = document.createElement('div');
        line.className = 'b-line';
        line.style.width = w + 'px';
        barcodeArea.appendChild(line);
      });

      // 12개 그리드 생성
      for (let i = 1; i <= 12; i++) {
        const div = document.createElement('div');
        div.className = 'item';
        div.innerHTML = `
                <span class="num">${String(i).padStart(2, '0')}</span>
                <span class="bracket">(</span>
                <div class="img-placeholder" id="img-${i}"></div>
                <span class="bracket">)</span>
            `;
        gallery.appendChild(div);
      }

      fileInput.onchange = (e) => {
        const files = Array.from(e.target.files);
        files.forEach((file) => {
          if (count >= 12) return;
          count++;
          const reader = new FileReader();
          reader.onload = (ev) => {
            document.getElementById(
              `img-${count}`
            ).innerHTML = `<img src="${ev.target.result}">`;
          };
          reader.readAsDataURL(file);
        });
      };

      saveBtn.onclick = () => {
        window.getSelection().removeAllRanges();
        html2canvas(document.getElementById('poster-area'), {
          scale: 4,
          useCORS: true,
          backgroundColor: '#ffffff',
        }).then((canvas) => {
          const link = document.createElement('a');
          link.download = `Archive_2025.png`;
          link.href = canvas.toDataURL('image/png');
          link.click();
        });
      };
    </script>
  </body>
</html>
